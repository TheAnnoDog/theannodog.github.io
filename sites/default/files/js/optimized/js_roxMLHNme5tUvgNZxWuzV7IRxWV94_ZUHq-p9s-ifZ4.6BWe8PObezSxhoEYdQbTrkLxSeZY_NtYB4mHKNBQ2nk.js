(function(e,i,a,t){var r=t.tabbable;i.MediaLibrary={currentSelection:[]};i.AjaxCommands.prototype.updateMediaLibrarySelection=function(e,a,t){Object.values(a.mediaIds).forEach(function(e){i.MediaLibrary.currentSelection.push(e)})};i.behaviors.MediaLibraryTabs={attach:function(a){var t=e('.js-media-library-menu');e(once('media-library-menu-item',t.find('a'))).on('keypress',function(i){if(i.which===32){i.preventDefault();i.stopPropagation();e(i.currentTarget).trigger('click')}}).on('click',function(a){a.preventDefault();a.stopPropagation();var n=i.ajax({wrapper:'media-library-content',url:a.currentTarget.href,dialogType:'ajax',progress:{type:'fullscreen',message:i.t('Please wait...')}});n.success=function(e,a){return Promise.resolve(i.Ajax.prototype.success.call(n,e,a)).then(function(){var i=document.getElementById('media-library-content');if(i){var e=r(i);if(e.length){e[0].focus()}}})};n.execute();t.find('.active-tab').remove();t.find('a').removeClass('active');e(a.currentTarget).addClass('active').html(i.t('<span class="visually-hidden">Show </span>@title<span class="visually-hidden"> media</span><span class="active-tab visually-hidden"> (selected)</span>',{'@title':e(a.currentTarget).data('title')}));i.announce(i.t('Showing @title media.',{'@title':e(a.currentTarget).data('title')}))})}};i.behaviors.MediaLibraryViewsDisplay={attach:function(a){var t=e(a).hasClass('.js-media-library-view')?e(a):e('.js-media-library-view',a);t.closest('.views-element-container').attr('id','media-library-view');e(once('media-library-views-display-link','.views-display-link-widget, .views-display-link-widget_table',a)).on('click',function(a){a.preventDefault();a.stopPropagation();var c=e(a.currentTarget),t='',r='',n='';if(c.hasClass('views-display-link-widget')){t=i.t('Loading grid view.');r=i.t('Changed to grid view.');n='.views-display-link-widget'}
else if(c.hasClass('views-display-link-widget_table')){t=i.t('Loading table view.');r=i.t('Changed to table view.');n='.views-display-link-widget_table'};var l=i.ajax({wrapper:'media-library-view',url:a.currentTarget.href,dialogType:'ajax',progress:{type:'fullscreen',message:t||i.t('Please wait...')}});if(r||n){var s=l.success;l.success=function(a,t){s.bind(this)(a,t);if(n){e(n).focus()};if(r){i.announce(r)}}};l.execute();if(t){i.announce(t)}})}};i.behaviors.MediaLibraryItemSelection={attach:function(t,n){var c=e('.js-media-library-views-form, .js-media-library-add-form',t),r=i.MediaLibrary.currentSelection;if(!c.length){return};var l=e('.js-media-library-item input[type="checkbox"]',c);function d(e){e.prop('disabled',!0).closest('.js-media-library-item').addClass('media-library-item--disabled')};function s(e){e.prop('disabled',!1).closest('.js-media-library-item').removeClass('media-library-item--disabled')};function o(a){var t=a<0?i.formatPlural(r.length,'1 item selected','@count items selected'):i.formatPlural(a,'@selected of @count item selected','@selected of @count items selected',{'@selected':r.length});e('.js-media-library-selected-count').html(t)};e(once('media-item-change',l)).on('change',function(i){var n=i.currentTarget.value,t=r.indexOf(n);if(i.currentTarget.checked){if(t===-1){r.push(n)}}
else if(t!==-1){r.splice(t,1)};var a=document.querySelector('#media-library-modal-selection');if(a){a.value=r.join();e(a).trigger('change')};document.querySelectorAll('.js-media-library-add-form-current-selection').forEach(function(e){e.value=r.join()})});e(once('media-library-selection-change',c.find('#media-library-modal-selection'))).on('change',function(e){o(n.media_library.selection_remaining);if(r.length===n.media_library.selection_remaining){d(l.not(':checked'));s(l.filter(':checked'))}
else{s(l)}});r.forEach(function(e){c.find('input[type="checkbox"][value="'.concat(e,'"]')).prop('checked',!0).trigger('change')});if(!once('media-library-selection-info','html').length){return};e(a).on('dialog:aftercreate',function(){var a=e('.media-library-widget-modal .ui-dialog-buttonpane');if(!a.length){return};a.append(i.theme('mediaLibrarySelectionCount'));o(n.media_library.selection_remaining)})}};i.behaviors.MediaLibraryModalClearSelection={attach:function(){if(!once('media-library-clear-selection','html').length){return};e(a).on('dialog:afterclose',function(){i.MediaLibrary.currentSelection=[]})}};i.theme.mediaLibrarySelectionCount=function(){return'<div class="media-library-selected-count js-media-library-selected-count" role="status" aria-live="polite" aria-atomic="true"></div>'}})(jQuery,Drupal,window,window.tabbable);