(function(e,i){i.behaviors.fileValidateAutoAttach={attach:function(a,t){var n=e(a),o;function l(a){e(once('fileValidate',n.find(a))).on('change.fileValidate',{extensions:o[a]},i.file.validateExtension)};if(t.file&&t.file.elements){o=t.file.elements;Object.keys(o).forEach(l)}},detach:function(a,t,o){var l=e(a),n;function f(a){e(once.remove('fileValidate',l.find(a))).off('change.fileValidate',i.file.validateExtension)};if(o==='unload'&&t.file&&t.file.elements){n=t.file.elements;Object.keys(n).forEach(f)}}};i.behaviors.fileAutoUpload={attach:function(a){e(once('auto-file-upload','input[type="file"]',a)).on('change.autoFileUpload',i.file.triggerUploadButton)},detach:function(i,a,t){if(t==='unload'){e(once.remove('auto-file-upload','input[type="file"]',i)).off('.autoFileUpload')}}};i.behaviors.fileButtons={attach:function(a){var t=e(a);t.find('.js-form-submit').on('mousedown',i.file.disableFields);t.find('.js-form-managed-file .js-form-submit').on('mousedown',i.file.progressBar)},detach:function(a,t,o){if(o==='unload'){var n=e(a);n.find('.js-form-submit').off('mousedown',i.file.disableFields);n.find('.js-form-managed-file .js-form-submit').off('mousedown',i.file.progressBar)}}};i.behaviors.filePreviewLinks={attach:function(a){e(a).find('div.js-form-managed-file .file a').on('click',i.file.openInNewWindow)},detach:function(a){e(a).find('div.js-form-managed-file .file a').off('click',i.file.openInNewWindow)}};i.file=i.file||{validateExtension:function(a){a.preventDefault();e('.file-upload-js-error').remove();var t=a.data.extensions.replace(/,\s*/g,'|');if(t.length>1&&this.value.length>0){var n=new RegExp('\\.('.concat(t,')$'),'gi');if(!n.test(this.value)){var o=i.t('The selected file %filename cannot be uploaded. Only files with the following extensions are allowed: %extensions.',{'%filename':this.value.replace('C:\\fakepath\\',''),'%extensions':t.replace(/\|/g,', ')});e(this).closest('div.js-form-managed-file').prepend('<div class="messages messages--error file-upload-js-error" aria-live="polite">'.concat(o,'</div>'));this.value='';a.stopImmediatePropagation()}}},triggerUploadButton:function(i){e(i.target).closest('.js-form-managed-file').find('.js-form-submit[data-drupal-selector$="upload-button"]').trigger('mousedown')},disableFields:function(i){var a=e(this);a.trigger('formUpdated');var o=[];if(a.closest('div.js-form-managed-file').length>0){o=a.closest('div.js-form-managed-file').find('input.js-form-file')};var t=e('div.js-form-managed-file input.js-form-file').not(o).not(':disabled');t.prop('disabled',!0);setTimeout(function(){t.prop('disabled',!1)},1000)},progressBar:function(i){var t=e(this),a=t.closest('div.js-form-managed-file').find('input.file-progress');if(a.length){var o=a.attr('name');a.attr('name',o.match(/APC_UPLOAD_PROGRESS|UPLOAD_IDENTIFIER/)[0]);setTimeout(function(){a.attr('name',o)},1000)};setTimeout(function(){t.closest('div.js-form-managed-file').find('div.ajax-progress-bar').slideDown()},500);t.trigger('fileUpload')},openInNewWindow:function(i){i.preventDefault();e(this).attr('target','_blank');window.open(this.href,'filePreview','toolbar=0,scrollbars=1,location=1,statusbar=1,menubar=0,resizable=1,width=500,height=550')}}})(jQuery,Drupal);